# Modern Chat 安装向导测试指南

## 快速测试步骤

### 1. 本地环境准备

确保您的本地环境满足以下要求：

- PHP >= 7.4.0
- MySQL >= 5.7.0
- Web 服务器（Apache/Nginx/XAMPP）

### 2. 启动 Web 服务器

#### 使用 PHP 内置服务器（仅用于测试）

```bash
cd /path/to/modern-chat
php -S localhost:8000
```

然后访问: http://localhost:8000

#### 使用 XAMPP/WAMP

1. 将 `modern-chat` 文件夹复制到 `htdocs` 目录
2. 启动 Apache 和 MySQL
3. 访问: http://localhost/modern-chat

### 3. 访问安装向导

系统会自动检测是否已安装：

- **未安装**: 自动跳转到 `/install.php`
- **已安装**: 跳转到 `/chat.php`

### 4. 测试安装流程

#### 步骤 1: 欢迎页面
- 检查版本信息是否正确显示
- 确认页面布局和样式正常

#### 步骤 2: 环境检测
- 点击"下一步"进入环境检测
- 检查所有检测项是否正确显示
- 验证通过/失败状态图标是否正确
- 测试环境要求未满足时能否正确提示

#### 步骤 3: 数据库配置

**测试场景 A - 正常安装**:
1. 填写正确的数据库配置
2. 点击"开始安装"
3. 验证能否成功连接数据库
4. 验证能否成功导入数据表
5. 验证能否成功创建安装锁

**测试场景 B - 数据库不存在**:
1. 填写一个不存在的数据库名称
2. 点击"开始安装"
3. 验证系统能否自动创建数据库

**测试场景 C - 数据库已存在表**:
1. 填写已安装的数据库配置
2. 点击"开始安装"
3. 验证是否弹出确认对话框
4. 测试选择"是"清空并重新导入
5. 测试选择"否"返回修改配置

**测试场景 D - 错误的数据库配置**:
1. 填写错误的数据库密码
2. 点击"开始安装"
3. 验证是否能正确显示错误提示

#### 步骤 4: 完成安装
- 检查安装成功提示
- 验证后续操作指引是否清晰
- 点击"进入系统"按钮
- 验证是否正确跳转到登录页面

### 5. 测试首次使用

#### 注册超级管理员
1. 点击"注册"按钮
2. 填写注册信息
3. 验证注册是否成功
4. 登录系统
5. 验证是否具有管理员权限

### 6. 测试重新安装

1. 删除根目录下的 `installed.lock` 文件
2. 刷新浏览器
3. 验证是否跳转到安装向导
4. 重新完成安装流程

## 环境检测预期结果

| 检测项 | 预期结果 | 说明 |
|--------|---------|------|
| PHP版本 | ✓ 成功 | >= 7.4.0 |
| PDO扩展 | ✓ 成功 | 必须安装 |
| PDO MySQL扩展 | ✓ 成功 | 必须安装 |
| Mbstring扩展 | ✓ 成功 | 必须安装 |
| GD库 | ! 警告/✓ 成功 | 可选 |
| Avatars目录权限 | ✓ 成功 | 必须可写 |
| Uploads目录权限 | ✓ 成功 | 必须可写 |
| Config目录权限 | ✓ 成功 | 必须可写 |

## 常见测试问题

### Q: 环境检测全部失败？
A: 检查 PHP 版本和扩展是否正确安装，确保目录具有写权限。

### Q: 数据库连接失败？
A:
1. 检查 MySQL 服务是否启动
2. 验证数据库用户名和密码是否正确
3. 确认数据库用户具有创建数据库和表的权限

### Q: 导入数据表失败？
A:
1. 确保 `db.sql` 文件存在
2. 检查文件编码是否为 UTF-8
3. 验证数据库连接配置是否正确

### Q: 无法创建安装锁？
A: 检查项目根目录是否具有写权限。

### Q: 安装后无法登录？
A: 这是正常的，需要先注册账户。首次注册的用户自动成为管理员。

## 测试检查清单

- [ ] 访问网站能自动跳转到安装向导
- [ ] 欢迎页面显示正常
- [ ] 环境检测所有项显示正确
- [ ] 数据库连接测试成功
- [ ] 数据表导入成功
- [ ] 配置文件更新成功
- [ ] 安装锁创建成功
- [ ] 完成页面显示正常
- [ ] 能正确跳转到登录页面
- [ ] 注册功能正常
- [ ] 登录功能正常
- [ ] 删除锁文件能重新安装

## 手动验证

### 检查安装锁
```bash
ls -la installed.lock
```

### 检查配置文件
```bash
cat config.php | grep "define('DB_"
```

### 检查数据库表
```bash
mysql -u root -p -e "USE chat; SHOW TABLES;"
```

### 检查数据库用户
```bash
mysql -u root -p -e "USE chat; SELECT COUNT(*) FROM users;"
```

## 浏览器兼容性测试

在以下浏览器中测试：

- [ ] Chrome/Edge (推荐)
- [ ] Firefox
- [ ] Safari
- [ ] 移动端浏览器

## 响应式测试

测试以下屏幕尺寸：

- 桌面端: 1920x1080, 1366x768
- 平板: 768x1024
- 手机: 375x667, 414x896

## 性能测试

- 安装流程应在 10 秒内完成（不含数据库导入）
- 数据库导入时间取决于数据量，通常在 5-30 秒内

## 安全测试

- [ ] SQL注入防护测试
- [ ] XSS防护测试
- [ ] 文件上传权限验证
- [ ] 安装后删除安装文件（可选）

## 已知问题

如有问题，请在 GitHub Issues 中提交。

---

**测试完成后，记得删除 `installed.lock` 文件以备下次测试！**
